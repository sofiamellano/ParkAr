<?xml version="1.0" encoding="utf-8" ?>
<ContentPage
    x:Class="AppMovil.Pages.TicketPage"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:viewmodels="clr-namespace:AppMovil.ViewModels"
    xmlns:converters="clr-namespace:AppMovil.Converters"
    Title="{Binding Title}"
    x:DataType="viewmodels:TicketPageViewModel">

    <ContentPage.Resources>
        <ResourceDictionary>
            <converters:InvertedBoolConverter x:Key="InvertedBoolConverter" />
        </ResourceDictionary>
    </ContentPage.Resources>

    <ScrollView>
        <StackLayout Padding="20" Spacing="25">

            <!-- âœ… HEADER DEL TICKET -->
            <Frame BackgroundColor="#4ECDC4" BorderColor="Transparent" CornerRadius="15" Padding="20" HasShadow="True">
                <StackLayout Spacing="10">
                    <Label 
                        Text="ðŸŽ« Ticket Digital" 
                        FontSize="24" 
                        FontAttributes="Bold" 
                        TextColor="White"
                        HorizontalOptions="Center" />
                    
                    <Label 
                        Text="{Binding NumeroTicket}" 
                        FontSize="18" 
                        FontAttributes="Bold" 
                        TextColor="White"
                        HorizontalOptions="Center" />
                        
                    <!-- âœ… ESTADO DEL TICKET -->
                    <Label 
                        Text="{Binding EstadoReserva, StringFormat='Estado: {0}'}" 
                        FontSize="14" 
                        FontAttributes="Bold" 
                        TextColor="White"
                        HorizontalOptions="Center" />
                </StackLayout>
            </Frame>

            <!-- âœ… INFORMACIÃ“N DE LA RESERVA -->
            <Frame BackgroundColor="White" BorderColor="LightGray" CornerRadius="10" HasShadow="True" Padding="20">
                <StackLayout Spacing="15">
                    <Label Text="ðŸ“‹ InformaciÃ³n de la Reserva" FontSize="18" FontAttributes="Bold" TextColor="#2C3E50" />
                    
                    <StackLayout Spacing="12">
                        <StackLayout Orientation="Horizontal">
                            <Label Text="ðŸ…¿ï¸ Lugar:" FontSize="14" FontAttributes="Bold" TextColor="#34495E" />
                            <Label Text="{Binding LugarReserva}" FontSize="14" TextColor="#2C3E50" />
                        </StackLayout>

                        <StackLayout Orientation="Horizontal">
                            <Label Text="ðŸ“… Fecha:" FontSize="14" FontAttributes="Bold" TextColor="#34495E" />
                            <Label Text="{Binding FechaReserva, StringFormat='{0:dd/MM/yyyy}'}" FontSize="14" TextColor="#2C3E50" />
                        </StackLayout>

                        <!-- âœ… HORARIOS -->
                        <StackLayout Orientation="Horizontal">
                            <Label Text="ðŸ• Inicio:" FontSize="14" FontAttributes="Bold" TextColor="#34495E" />
                            <Label Text="{Binding HoraInicio}" FontSize="14" TextColor="#2C3E50" />
                        </StackLayout>
                        
                        <StackLayout Orientation="Horizontal">
                            <Label Text="ðŸ•• Fin:" FontSize="14" FontAttributes="Bold" TextColor="#34495E" />
                            <Label Text="{Binding HoraFin}" FontSize="14" TextColor="#2C3E50" />
                        </StackLayout>

                        <!-- âœ… INFORMACIÃ“N DEL VEHÃCULO -->
                        <StackLayout Orientation="Horizontal">
                            <Label Text="ðŸš— VehÃ­culo:" FontSize="14" FontAttributes="Bold" TextColor="#34495E" />
                            <Label Text="{Binding VehiculoInfo}" FontSize="14" TextColor="#2C3E50" />
                        </StackLayout>
                    </StackLayout>
                </StackLayout>
            </Frame>

            <!-- âœ… INDICADOR DE CARGA -->
            <ActivityIndicator IsRunning="{Binding IsBusy}"
                              IsVisible="{Binding IsBusy}"
                              Color="#4ECDC4"
                              HeightRequest="40" />

            <!-- âœ… MENSAJE DE VALIDEZ DEL TICKET -->
            <Frame BackgroundColor="#E8F5E8" 
                   BorderColor="#4CAF50" 
                   CornerRadius="8" 
                   Padding="15"
                   Margin="0,10,0,0"
                   IsVisible="{Binding IsTicketValid}">
                <StackLayout Orientation="Horizontal" HorizontalOptions="Center">
                    <Label Text="âœ…" FontSize="16" />
                    <Label Text="Ticket VÃ¡lido" 
                           FontSize="14" 
                           FontAttributes="Bold" 
                           TextColor="#2E7D32"
                           VerticalOptions="Center" />
                </StackLayout>
            </Frame>

            <Frame BackgroundColor="#FFEBEE" 
                   BorderColor="#F44336" 
                   CornerRadius="8" 
                   Padding="15"
                   Margin="0,10,0,0"
                   IsVisible="{Binding IsTicketValid, Converter={StaticResource InvertedBoolConverter}}">
                <StackLayout Orientation="Horizontal" HorizontalOptions="Center">
                    <Label Text="âŒ" FontSize="16" />
                    <Label Text="Ticket Expirado/Cancelado" 
                           FontSize="14" 
                           FontAttributes="Bold" 
                           TextColor="#C62828"
                           VerticalOptions="Center" />
                </StackLayout>
            </Frame>

            <!-- âœ… BOTONES DE ACCIÃ“N -->
            <StackLayout Spacing="12" Margin="0,20,0,0">
                <Button 
                    Text="ðŸ”„ Actualizar Ticket"
                    Command="{Binding RefreshTicketCommand}"
                    BackgroundColor="#3498DB"
                    TextColor="White"
                    CornerRadius="10"
                    HeightRequest="50"
                    FontSize="16"
                    FontAttributes="Bold" />

                <Button 
                    Text="â† Volver"
                    Command="{Binding GoBackCommand}"
                    BackgroundColor="Transparent"
                    TextColor="#3498DB"
                    BorderColor="#3498DB"
                    BorderWidth="2"
                    CornerRadius="10"
                    HeightRequest="50"
                    FontSize="16"
                    FontAttributes="Bold" />
            </StackLayout>

        </StackLayout>
    </ScrollView>

</ContentPage>